{"pageProps":{"post":{"attributes":{"description":""},"html":"<p>So far we&#39;ve done a one to one matching of records. We&#39;ve used a record in a database to represent one item: a vegetable, a fruit, so on and so forth.</p>\n<p>Now we&#39;re going to get into records that can relate to each other. Let&#39;s think about recipes. A recipe has multiple ingredients. That <strong>has</strong> word is key here. It means there is a relationship. A single recipe has many ingredients. An ingredient can also be in many recipes. A tomato is both in pizza sauce and in a BLT. This is called a many-to-many relationship.</p>\n<p>There&#39;s also one-to-many relationships, like imagine if we had multiple photos of each of our ingredients. A single ingredient will have five photos. And those photos will only will only belong to one ingredient. A photo of a green pepper doesn&#39;t make sense to belong to anything besides the green pepper ingredient.</p>\n<p>There can also exist one-to-one relationships but in general you would just make those the same record all together. You could split up the type and title into two tables, but why would you.</p>\n<h2 id=\"a-basic-relationship\">A basic relationship</h2>\n<p>We&#39;re going to do this a na√Øve wrong way, and then we&#39;re going to do it the correct way.</p>\n<p>First thing we&#39;re going to make a recipes table</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> recipes (\n  recipe_id <span class=\"hljs-type\">INTEGER</span> <span class=\"hljs-keyword\">PRIMARY</span> KEY GENERATED ALWAYS <span class=\"hljs-keyword\">AS</span> <span class=\"hljs-keyword\">IDENTITY</span>,\n  title <span class=\"hljs-type\">VARCHAR</span> ( <span class=\"hljs-number\">255</span> ) <span class=\"hljs-keyword\">UNIQUE</span> <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span>,\n  body TEXT\n);\n</code></pre>\n<p>Okay, no rocket science so far. We just created another random table. Let&#39;s say we could have many images of a single recipe. How would we go about doing that?</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">INSERT</span> <span class=\"hljs-keyword\">INTO</span> recipes\n  (title, body)\n<span class=\"hljs-keyword\">VALUES</span>\n  (<span class=\"hljs-string\">&#x27;cookies&#x27;</span>, <span class=\"hljs-string\">&#x27;very yummy&#x27;</span>),\n  (<span class=\"hljs-string\">&#x27;empanada&#x27;</span>,<span class=\"hljs-string\">&#x27;ugh so good&#x27;</span>),\n  (<span class=\"hljs-string\">&#x27;jollof rice&#x27;</span>, <span class=\"hljs-string\">&#x27;spectacular&#x27;</span>),\n  (<span class=\"hljs-string\">&#x27;shakshuka&#x27;</span>,<span class=\"hljs-string\">&#x27;absolutely wonderful&#x27;</span>),\n  (<span class=\"hljs-string\">&#x27;khachapuri&#x27;</span>, <span class=\"hljs-string\">&#x27;breakfast perfection&#x27;</span>),\n  (<span class=\"hljs-string\">&#x27;xiao long bao&#x27;</span>, <span class=\"hljs-string\">&#x27;god I want some dumplings right now&#x27;</span>);\n</code></pre>\n<blockquote>\n<p>Pro tip: don&#39;t write a course while hungry.</p>\n</blockquote>\n<p>Okay, we now have a bunch of recipes. Our problem now is that we have a variable amount of photos for each recipe. Perhaps we have one picture of cookies but we have four pictures of jollof rice. How do we model that if we always have a fixed amount columns?</p>\n<p>One approach would be to say &quot;I only have at most five pictures of any recipes, I&#39;ll make columns pic1 through pic5 columns and limit myself to that&quot;. Totally valid approach, and if you can guarantee only 5 images at most, it might be the right approach.</p>\n<p>But what if we can&#39;t guarantee that? We need some sort of flexibility. This is where we can use two tables.</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">CREATE</span> <span class=\"hljs-keyword\">TABLE</span> recipes_photos (\n  photo_id <span class=\"hljs-type\">INTEGER</span> <span class=\"hljs-keyword\">PRIMARY</span> KEY GENERATED ALWAYS <span class=\"hljs-keyword\">AS</span> <span class=\"hljs-keyword\">IDENTITY</span>,\n  recipe_id <span class=\"hljs-type\">INTEGER</span>,\n  url <span class=\"hljs-type\">VARCHAR</span>(<span class=\"hljs-number\">255</span>) <span class=\"hljs-keyword\">NOT</span> <span class=\"hljs-keyword\">NULL</span>\n);\n</code></pre>\n<p>Now we can insert a some rows to reference images that we have.</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">INSERT</span> <span class=\"hljs-keyword\">INTO</span> recipes_photos\n  (recipe_id, url)\n<span class=\"hljs-keyword\">VALUES</span>\n  (<span class=\"hljs-number\">1</span>, <span class=\"hljs-string\">&#x27;cookies1.jpg&#x27;</span>),\n  (<span class=\"hljs-number\">1</span>, <span class=\"hljs-string\">&#x27;cookies2.jpg&#x27;</span>),\n  (<span class=\"hljs-number\">1</span>, <span class=\"hljs-string\">&#x27;cookies3.jpg&#x27;</span>),\n  (<span class=\"hljs-number\">1</span>, <span class=\"hljs-string\">&#x27;cookies4.jpg&#x27;</span>),\n  (<span class=\"hljs-number\">1</span>, <span class=\"hljs-string\">&#x27;cookies5.jpg&#x27;</span>),\n  (<span class=\"hljs-number\">2</span>, <span class=\"hljs-string\">&#x27;empanada1.jpg&#x27;</span>),\n  (<span class=\"hljs-number\">2</span>, <span class=\"hljs-string\">&#x27;empanada2.jpg&#x27;</span>),\n  (<span class=\"hljs-number\">3</span>, <span class=\"hljs-string\">&#x27;jollof1.jpg&#x27;</span>),\n  (<span class=\"hljs-number\">4</span>, <span class=\"hljs-string\">&#x27;shakshuka1.jpg&#x27;</span>),\n  (<span class=\"hljs-number\">4</span>, <span class=\"hljs-string\">&#x27;shakshuka2.jpg&#x27;</span>),\n  (<span class=\"hljs-number\">4</span>, <span class=\"hljs-string\">&#x27;shakshuka3.jpg&#x27;</span>),\n  (<span class=\"hljs-number\">5</span>, <span class=\"hljs-string\">&#x27;khachapuri1.jpg&#x27;</span>),\n  (<span class=\"hljs-number\">5</span>, <span class=\"hljs-string\">&#x27;khachapuri2.jpg&#x27;</span>);\n<span class=\"hljs-comment\">-- no pictures of xiao long bao</span>\n</code></pre>\n<p>Okay, now let&#39;s select all the photos for shakshuka. Shakshuka is ID 4 (if you followed my instructions, feel free to drop tables and recreate them if you need to.)</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT</span> title, body <span class=\"hljs-keyword\">FROM</span> recipes <span class=\"hljs-keyword\">WHERE</span> recipe_id <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">4</span>;\n<span class=\"hljs-keyword\">SELECT</span> url <span class=\"hljs-keyword\">FROM</span> recipes_photos <span class=\"hljs-keyword\">WHERE</span> recipe_id <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">4</span>;\n</code></pre>\n<p>It&#39;d be cool if we could do these all at the same time. Some sort inner section of a venn diagram, right? You can!</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT</span> recipes.title, recipes.body, recipes_photos.url\n  <span class=\"hljs-keyword\">FROM</span> recipes_photos\n  <span class=\"hljs-keyword\">INNER</span> <span class=\"hljs-keyword\">JOIN</span>\n    recipes\n  <span class=\"hljs-keyword\">ON</span>\n    recipes_photos.recipe_id <span class=\"hljs-operator\">=</span> recipes.recipe_id\n  <span class=\"hljs-keyword\">WHERE</span> recipes_photos.recipe_id <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">4</span>;\n</code></pre>\n<p>Amazing!!</p>\n<p>Now we&#39;re getting data from each table smushed together. The data from recipes will be repeated over item in the recipes_photos table but that&#39;s what we expect.</p>\n<p>Just to show you some common shorthand (but otherwise same query)</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT</span> r.title, r.body, rp.url\n  <span class=\"hljs-keyword\">FROM</span> recipes_photos rp\n  <span class=\"hljs-keyword\">INNER</span> <span class=\"hljs-keyword\">JOIN</span>\n    recipes r\n  <span class=\"hljs-keyword\">ON</span>\n    rp.recipe_id <span class=\"hljs-operator\">=</span> r.recipe_id\n  <span class=\"hljs-keyword\">WHERE</span> rp.recipe_id <span class=\"hljs-operator\">=</span> <span class=\"hljs-number\">4</span>;\n</code></pre>\n<p>Go ahead and try this to see the full inner join.</p>\n<pre><code class=\"hljs language-sql\"><span class=\"hljs-keyword\">SELECT</span> r.title, r.body, rp.url\n  <span class=\"hljs-keyword\">FROM</span> recipes_photos rp\n  <span class=\"hljs-keyword\">INNER</span> <span class=\"hljs-keyword\">JOIN</span>\n    recipes r\n  <span class=\"hljs-keyword\">ON</span>\n    rp.recipe_id <span class=\"hljs-operator\">=</span> r.recipe_id;\n</code></pre>\n<p>Pretty cool, right?</p>\n","slug":"relationships","title":"Relationships","section":"Joins and Constraints","icon":"code-merge","filePath":"/home/runner/work/complete-intro-to-sql/complete-intro-to-sql/lessons/04-joins-and-constraints/A-relationships.md","nextSlug":"/lessons/joins-and-constraints/other-types-of-joins","prevSlug":"/lessons/data/project"}},"__N_SSG":true}