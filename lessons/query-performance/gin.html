<!DOCTYPE html><html><head><meta name="viewport" content="width=device-width"/><meta charSet="utf-8"/><link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon.png"/><link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32.png"/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"/><link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16.png"/><link rel="icon" type="image/x-icon" href="/images/favicon.ico"/><title>GIN – Complete Intro to SQL</title><meta name="description" content="Come learn the basics to querying SQL and managing PostgreSQL with industry expert Brian Holt"/><meta name="og:description" content="Come learn the basics to querying SQL and managing PostgreSQL with industry expert Brian Holt"/><meta name="og:title" content="GIN – Complete Intro to SQL"/><meta name="og:image" content="/images/social-share-cover.jpg"/><meta name="twitter:card" content="summary_large_image"/><meta name="next-head-count" content="13"/><link rel="preload" href="/_next/static/css/c0d0590379c832c9.css" as="style"/><link rel="stylesheet" href="/_next/static/css/c0d0590379c832c9.css" data-n-g=""/><noscript data-n-css=""></noscript><script defer="" nomodule="" src="/_next/static/chunks/polyfills-5cd94c89d3acac5f.js"></script><script src="/_next/static/chunks/webpack-fd82975a6094609f.js" defer=""></script><script src="/_next/static/chunks/framework-a87821de553db91d.js" defer=""></script><script src="/_next/static/chunks/main-d8b1ff545a609496.js" defer=""></script><script src="/_next/static/chunks/pages/_app-41c0821e3ebe9d40.js" defer=""></script><script src="/_next/static/chunks/pages/lessons/%5Bsection%5D/%5Bslug%5D-e748a5e7fda443d2.js" defer=""></script><script src="/_next/static/L1nvFuMYgj19ON5bFBK-W/_buildManifest.js" defer=""></script><script src="/_next/static/L1nvFuMYgj19ON5bFBK-W/_ssgManifest.js" defer=""></script><script src="/_next/static/L1nvFuMYgj19ON5bFBK-W/_middlewareManifest.js" defer=""></script></head><body><div id="__next"><div class="remix-app"><header class="navbar"><h1 class="navbar-brand"><a href="/">Complete Intro to SQL</a></h1><div class="navbar-info"><a href="https://holt.fyi/sql" class="cta-btn">Watch on Frontend Masters</a></div></header><div class="content-container"><div class="main"><div class="lesson-container"><div class="lesson"><div class="lesson-content"><p>GIN stands for generalized inverted index. It&#39;s another data structure for indexes. In this case it&#39;s really useful for things where multiple values could apply to one row. A good example of this would be with JSONB columns: you have one column but it could have multiple values inside the object that a search could find. Fathom the below example:</p>
<blockquote>
<p>If you run these queries, you&#39;ll see it&#39;s still using sequential scan. You need pretty big tables (200+ rows? that&#39;s an estimate) for it to start being worth it to use your index.</p>
</blockquote>
<pre><code class="hljs language-sql"><span class="hljs-keyword">CREATE</span> <span class="hljs-keyword">TABLE</span> movie_reviews (
  id <span class="hljs-type">INTEGER</span> <span class="hljs-keyword">PRIMARY</span> KEY GENERATED ALWAYS <span class="hljs-keyword">AS</span> <span class="hljs-keyword">IDENTITY</span>,
  movie_id <span class="hljs-type">INTEGER</span>,
  scores JSONB <span class="hljs-keyword">NOT</span> <span class="hljs-keyword">NULL</span>
);

<span class="hljs-keyword">INSERT</span> <span class="hljs-keyword">INTO</span>
  movie_reviews
  (movie_id, scores)
<span class="hljs-keyword">VALUES</span>
  (<span class="hljs-number">21103</span>, <span class="hljs-string">&#x27;{ &quot;rotten_tomatoes&quot;: 94, &quot;washington_post&quot;: 50, &quot;nytimes&quot;: 45 }&#x27;</span>),
  (<span class="hljs-number">97</span>, <span class="hljs-string">&#x27;{ &quot;rotten_tomatoes&quot;: 87, &quot;washington_post&quot;: 40 }&#x27;</span>),
  (<span class="hljs-number">18235</span>, <span class="hljs-string">&#x27;{ &quot;rolling_stone&quot;: 85, &quot;washington_post&quot;: 60, &quot;nytimes&quot;: 35 }&#x27;</span>),
  (<span class="hljs-number">10625</span>, <span class="hljs-string">&#x27;{ &quot;rotten_tomatoes&quot;: 100, &quot;washington_post&quot;: 100, &quot;nytimes&quot;: 100, &quot;rolling_stone&quot;: 100 }&#x27;</span>),
  (<span class="hljs-number">85014</span>, <span class="hljs-string">&#x27;{ &quot;nytimes&quot;: 67 }&#x27;</span>),
  (<span class="hljs-number">2493</span>, <span class="hljs-string">&#x27;{ &quot;rotten_tomatoes&quot;: 67, &quot;rolling_stone&quot;: 89, &quot;nytimes&quot;: 85 }&#x27;</span>),
  (<span class="hljs-number">11362</span>, <span class="hljs-string">&#x27;{ &quot;rotten_tomatoes&quot;: 76, &quot;washington_post&quot;: 14, &quot;nytimes&quot;: 98 }&#x27;</span>),
  (<span class="hljs-number">674</span>, <span class="hljs-string">&#x27;{ &quot;rotten_tomatoes&quot;: 78, &quot;washington_post&quot;: 40, &quot;nytimes&quot;: 77, &quot;rolling_stone&quot;: 54 }&#x27;</span>);

<span class="hljs-keyword">CREATE</span> INDEX <span class="hljs-keyword">ON</span> movie_reviews <span class="hljs-keyword">USING</span> gin(scores);
EXPLAIN ANALYZE <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> movie_reviews <span class="hljs-keyword">WHERE</span> scores ? <span class="hljs-string">&#x27;rolling_stone&#x27;</span>;
EXPLAIN ANALYZE <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span>  <span class="hljs-keyword">FROM</span> movie_reviews <span class="hljs-keyword">WHERE</span> scores @<span class="hljs-operator">&gt;</span> <span class="hljs-string">&#x27;{&quot;nytimes&quot;: 98}&#x27;</span>;
</code></pre>
<p>The above queries on a large table would be a great fit for a GIN index.</p>
<h2 id="gin-and-full-text-search">GIN and Full Text Search</h2>
<p>GIN, like we said before, is good for things where you can have one column that have multiple values that can return true. So what if we took our search term (in this case let&#39;s search for <code>star wars</code>) and broke it down in smaller, searchable pieces? Like, three letter pieces, or as they&#39;re called, <em>trigrams</em>. This is one way PostgreSQL can handle full text search.</p>
<pre><code class="hljs language-sql"><span class="hljs-keyword">SELECT</span> SHOW_TRGM(<span class="hljs-string">&#x27;star wars&#x27;</span>);
</code></pre>
<p>This shows you how PostgreSQL will break down star wars into multiple trigrams. It&#39;ll then search based on these and will use GIN to index these in the same fashioned it can index JSONB. Wild one technology works so well in two different ways.</p>
<pre><code class="hljs language-sql">EXPLAIN ANALYZE <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> movies <span class="hljs-keyword">WHERE</span> name ILIKE <span class="hljs-string">&#x27;%star wars%&#x27;</span>;

<span class="hljs-keyword">CREATE</span> INDEX <span class="hljs-keyword">ON</span> movies <span class="hljs-keyword">USING</span> gin(name gin_trgm_ops);

EXPLAIN ANALYZE <span class="hljs-keyword">SELECT</span> <span class="hljs-operator">*</span> <span class="hljs-keyword">FROM</span> movies <span class="hljs-keyword">WHERE</span> name ILIKE <span class="hljs-string">&#x27;%star wars%&#x27;</span>;
</code></pre>
<p>The <code>gin_trgm_ops</code> specifies the kind of indexing we want to do here and we&#39;re saying we want <code>trgm</code> or trigram operations. This is what you do for full text search.</p>
<p>You should see a large difference between the two queries. My machine got <code>cost=0.00..4929.51</code> for the first query and <code>cost=28.13..88.65</code> for the second query.</p>
<blockquote>
<p>As you can see, using the index is nearly half the cost of the second query and which is why we&#39;d need a pretty big data set for the JSONB query to use the index.</p>
</blockquote>
</div><div class="lesson-links"><a href="/lessons/query-performance/create-an-index" class="prev">← Previous</a><a href="/lessons/query-performance/partial-indexes" class="next">Next →</a></div></div><div class="details-bg"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="154" height="154" viewBox="0 0 154 154"><defs><clipPath id="clip-path"><rect id="Rectangle_2238" data-name="Rectangle 2238" width="154" height="154" transform="translate(9467 350)" fill="#fff" stroke="#707070" stroke-width="1"></rect></clipPath><clipPath id="clip-corner-image-active"><rect width="154" height="154"></rect></clipPath></defs><g id="corner-image-active" clip-path="url(#clip-corner-image-active)"><g id="Corner-image-active-2" data-name="Corner-image-active" transform="translate(-9467 -350)" clip-path="url(#clip-path)"><path id="Subtraction_34" data-name="Subtraction 34" d="M-3857.365,1740.766h0l-7.07-7.07,12.89-12.89v14.142l-5.818,5.818Zm-14.142-14.142h0l-7.071-7.07,27.033-27.033v14.143l-19.96,19.96Zm-14.143-14.143h0l-7.07-7.069,41.175-41.175v14.142Zm-14.142-14.142h0l-7.07-7.069,55.317-55.317v14.142Zm-14.142-14.142h0l-7.07-7.069,69.459-69.459v14.142Zm-14.142-14.142h0l-7.07-7.069,76.739-76.739h6.862v7.28Zm-14.143-14.143h0l-7.07-7.069,62.6-62.6h14.142Zm-14.142-14.142h0l-7.07-7.069,48.454-48.454h14.142Zm-14.142-14.142h0l-7.07-7.069,34.312-34.312h14.142Zm-14.142-14.142h0l-7.07-7.069,20.17-20.17h14.142Zm-14.142-14.142h0l-7.071-7.071,6.027-6.027h14.144l-13.1,13.1Zm367.24-56.114v-.909l.455.455-.453.453Z" transform="translate(13472.546 -1236.766)" fill="var(--corner-fill)"></path></g></g></svg></div></div></div></div><footer class="footer"><ul class="socials"><li class="social"><a href="https://twitter.com/holtbt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="40" height="32" viewBox="0 0 40 32"><defs><clipPath id="clip-twitter-social"><rect width="40" height="32"></rect></clipPath></defs><g id="twitter-social" clip-path="url(#clip-twitter-social)"><g id="Group_269" data-name="Group 269" transform="translate(-230.23 -1140.849)"><path id="Path_419" data-name="Path 419" d="M266.12,1148.861v1.035a23.092,23.092,0,0,1-1.507,8.1,24.08,24.08,0,0,1-4.475,7.381,22.175,22.175,0,0,1-7.306,5.4,24.129,24.129,0,0,1-10,2.07,23.7,23.7,0,0,1-6.667-.945,22.83,22.83,0,0,1-5.936-2.655q.959.091,1.963.09a16.518,16.518,0,0,0,5.434-.9,17.111,17.111,0,0,0,4.749-2.52,8.275,8.275,0,0,1-4.749-1.643,7.8,7.8,0,0,1-2.877-3.983,8.268,8.268,0,0,0,1.507.135,8.58,8.58,0,0,0,2.146-.27,8.16,8.16,0,0,1-5.685-4.344,8.326,8.326,0,0,1-.89-3.578v-.135a7.775,7.775,0,0,0,3.744,1.035,8.183,8.183,0,0,1-2.671-2.9,7.817,7.817,0,0,1-.982-3.848,7.948,7.948,0,0,1,1.1-4.05,23.53,23.53,0,0,0,16.895,8.46,9.221,9.221,0,0,1-.183-1.845,7.787,7.787,0,0,1,1.1-4.05,8.216,8.216,0,0,1,2.991-2.948,7.991,7.991,0,0,1,4.087-1.1,8.184,8.184,0,0,1,5.982,2.566,16.087,16.087,0,0,0,5.205-1.98,7.784,7.784,0,0,1-1.393,2.588,8.4,8.4,0,0,1-2.215,1.913,16.856,16.856,0,0,0,4.749-1.305A17.032,17.032,0,0,1,266.12,1148.861Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><a href="https://github.com/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-github-social"><rect width="32" height="32"></rect></clipPath></defs><g id="github-social" clip-path="url(#clip-github-social)"><g id="Group_272" data-name="Group 272" transform="translate(13522.5 -6994)"><path id="Subtraction_33" data-name="Subtraction 33" d="M-24967.5,8041a15.9,15.9,0,0,1-11.312-4.688A15.893,15.893,0,0,1-24983.5,8025a15.893,15.893,0,0,1,4.689-11.315A15.894,15.894,0,0,1-24967.5,8009a15.894,15.894,0,0,1,11.313,4.686A15.893,15.893,0,0,1-24951.5,8025a15.893,15.893,0,0,1-4.689,11.313A15.9,15.9,0,0,1-24967.5,8041Zm-3.781-4.571h0v3.918h7.895v-6.665a1.836,1.836,0,0,0-1.2-1.718c5.1-.617,7.467-2.975,7.467-7.424a7.176,7.176,0,0,0-1.637-4.728,6.74,6.74,0,0,0,.275-1.812,4.34,4.34,0,0,0-.52-2.452.574.574,0,0,0-.359-.1c-1.061,0-3.465,1.411-3.936,1.694a16.644,16.644,0,0,0-4.2-.489,16.379,16.379,0,0,0-3.969.445c-.846-.5-2.91-1.649-3.859-1.649a.566.566,0,0,0-.354.095,4.3,4.3,0,0,0-.521,2.452,6.7,6.7,0,0,0,.244,1.718,7.346,7.346,0,0,0-1.6,4.822,7.263,7.263,0,0,0,1.533,4.985c1.193,1.359,3.115,2.165,5.871,2.464a1.826,1.826,0,0,0-1.129,1.693v.5h0l-.006,0a7.121,7.121,0,0,1-2.033.363,2.608,2.608,0,0,1-.965-.158,4.438,4.438,0,0,1-1.836-1.881,2.361,2.361,0,0,0-1.248-1.091,3.472,3.472,0,0,0-1.217-.3.584.584,0,0,0-.545.224.282.282,0,0,0,.027.367,1.875,1.875,0,0,0,.447.307,4.732,4.732,0,0,1,.561.355,10.726,10.726,0,0,1,1.682,2.755c.043.092.078.163.105.217a3.876,3.876,0,0,0,2.42,1.185,6.036,6.036,0,0,0,.607.025c.875,0,1.988-.124,2-.125Z" transform="translate(11461 -1015)" fill="var(--footer-icons)"></path><g id="Ellipse_670" data-name="Ellipse 670" transform="translate(-13522.5 6994)" fill="none" stroke="var(--footer-icons)" stroke-width="1"><circle cx="16" cy="16" r="16" stroke="none"></circle><circle cx="16" cy="16" r="15.5" fill="none"></circle></g></g></g></svg></a></li><li class="social"><a href="https://linkedin.com/in/btholt"><svg xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" width="32" height="32" viewBox="0 0 32 32"><defs><clipPath id="clip-linkedin-social"><rect width="32" height="32"></rect></clipPath></defs><g id="linkedin-social" clip-path="url(#clip-linkedin-social)"><g id="Group_270" data-name="Group 270" transform="translate(-86.349 -633.073)"><path id="Path_375" data-name="Path 375" d="M115.789,633.073a2.324,2.324,0,0,1,1.682.676,2.194,2.194,0,0,1,.695,1.627V662.8a2.131,2.131,0,0,1-.695,1.609,2.314,2.314,0,0,1-1.646.659H88.69a2.307,2.307,0,0,1-1.646-.659,2.128,2.128,0,0,1-.695-1.609V635.376a2.19,2.19,0,0,1,.695-1.627,2.322,2.322,0,0,1,1.682-.676h27.063Zm-20.224,9.672a2.561,2.561,0,0,0,0-3.584,2.658,2.658,0,0,0-1.938-.712,2.724,2.724,0,0,0-1.957.712,2.371,2.371,0,0,0-.75,1.792,2.4,2.4,0,0,0,.731,1.792,2.605,2.605,0,0,0,1.9.713h.037A2.7,2.7,0,0,0,95.565,642.745ZM96,645.434H91.213V659.88H96Zm17.3,6.144a7.007,7.007,0,0,0-1.573-4.9,5.68,5.68,0,0,0-6.839-.769,5.663,5.663,0,0,0-1.426,1.573v-2.048H98.674q.036.841,0,7.717v6.728h4.791V651.8a3.592,3.592,0,0,1,.146-1.17,2.913,2.913,0,0,1,.878-1.206,2.429,2.429,0,0,1,1.609-.549,2.108,2.108,0,0,1,1.865.914,4.265,4.265,0,0,1,.549,2.341v7.752H113.3Z" fill="var(--footer-icons)"></path></g></g></svg></a></li><li class="social"><div class="terms"><p>Content Licensed Under CC-BY-NC-4.0</p><p>Code Samples and Excercises Licensed Under Apache 2.0</p><p>Site Designed by<!-- --> <!-- --><a href="https://www.alexdanielson.com/">Alex Danielson</a></p></div></li></ul></footer></div><script async="" defer="" src="https://a.holt.courses/latest.js"></script><noscript><img src="https://a.holt.courses/noscript.gif" alt="" referrerPolicy="no-referrer-when-downgrade"/></noscript></div><script id="__NEXT_DATA__" type="application/json">{"props":{"pageProps":{"post":{"attributes":{"title":"GIN"},"html":"\u003cp\u003eGIN stands for generalized inverted index. It\u0026#39;s another data structure for indexes. In this case it\u0026#39;s really useful for things where multiple values could apply to one row. A good example of this would be with JSONB columns: you have one column but it could have multiple values inside the object that a search could find. Fathom the below example:\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eIf you run these queries, you\u0026#39;ll see it\u0026#39;s still using sequential scan. You need pretty big tables (200+ rows? that\u0026#39;s an estimate) for it to start being worth it to use your index.\u003c/p\u003e\n\u003c/blockquote\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-sql\"\u003e\u003cspan class=\"hljs-keyword\"\u003eCREATE\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eTABLE\u003c/span\u003e movie_reviews (\n  id \u003cspan class=\"hljs-type\"\u003eINTEGER\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003ePRIMARY\u003c/span\u003e KEY GENERATED ALWAYS \u003cspan class=\"hljs-keyword\"\u003eAS\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eIDENTITY\u003c/span\u003e,\n  movie_id \u003cspan class=\"hljs-type\"\u003eINTEGER\u003c/span\u003e,\n  scores JSONB \u003cspan class=\"hljs-keyword\"\u003eNOT\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eNULL\u003c/span\u003e\n);\n\n\u003cspan class=\"hljs-keyword\"\u003eINSERT\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eINTO\u003c/span\u003e\n  movie_reviews\n  (movie_id, scores)\n\u003cspan class=\"hljs-keyword\"\u003eVALUES\u003c/span\u003e\n  (\u003cspan class=\"hljs-number\"\u003e21103\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;{ \u0026quot;rotten_tomatoes\u0026quot;: 94, \u0026quot;washington_post\u0026quot;: 50, \u0026quot;nytimes\u0026quot;: 45 }\u0026#x27;\u003c/span\u003e),\n  (\u003cspan class=\"hljs-number\"\u003e97\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;{ \u0026quot;rotten_tomatoes\u0026quot;: 87, \u0026quot;washington_post\u0026quot;: 40 }\u0026#x27;\u003c/span\u003e),\n  (\u003cspan class=\"hljs-number\"\u003e18235\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;{ \u0026quot;rolling_stone\u0026quot;: 85, \u0026quot;washington_post\u0026quot;: 60, \u0026quot;nytimes\u0026quot;: 35 }\u0026#x27;\u003c/span\u003e),\n  (\u003cspan class=\"hljs-number\"\u003e10625\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;{ \u0026quot;rotten_tomatoes\u0026quot;: 100, \u0026quot;washington_post\u0026quot;: 100, \u0026quot;nytimes\u0026quot;: 100, \u0026quot;rolling_stone\u0026quot;: 100 }\u0026#x27;\u003c/span\u003e),\n  (\u003cspan class=\"hljs-number\"\u003e85014\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;{ \u0026quot;nytimes\u0026quot;: 67 }\u0026#x27;\u003c/span\u003e),\n  (\u003cspan class=\"hljs-number\"\u003e2493\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;{ \u0026quot;rotten_tomatoes\u0026quot;: 67, \u0026quot;rolling_stone\u0026quot;: 89, \u0026quot;nytimes\u0026quot;: 85 }\u0026#x27;\u003c/span\u003e),\n  (\u003cspan class=\"hljs-number\"\u003e11362\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;{ \u0026quot;rotten_tomatoes\u0026quot;: 76, \u0026quot;washington_post\u0026quot;: 14, \u0026quot;nytimes\u0026quot;: 98 }\u0026#x27;\u003c/span\u003e),\n  (\u003cspan class=\"hljs-number\"\u003e674\u003c/span\u003e, \u003cspan class=\"hljs-string\"\u003e\u0026#x27;{ \u0026quot;rotten_tomatoes\u0026quot;: 78, \u0026quot;washington_post\u0026quot;: 40, \u0026quot;nytimes\u0026quot;: 77, \u0026quot;rolling_stone\u0026quot;: 54 }\u0026#x27;\u003c/span\u003e);\n\n\u003cspan class=\"hljs-keyword\"\u003eCREATE\u003c/span\u003e INDEX \u003cspan class=\"hljs-keyword\"\u003eON\u003c/span\u003e movie_reviews \u003cspan class=\"hljs-keyword\"\u003eUSING\u003c/span\u003e gin(scores);\nEXPLAIN ANALYZE \u003cspan class=\"hljs-keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e*\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFROM\u003c/span\u003e movie_reviews \u003cspan class=\"hljs-keyword\"\u003eWHERE\u003c/span\u003e scores ? \u003cspan class=\"hljs-string\"\u003e\u0026#x27;rolling_stone\u0026#x27;\u003c/span\u003e;\nEXPLAIN ANALYZE \u003cspan class=\"hljs-keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e*\u003c/span\u003e  \u003cspan class=\"hljs-keyword\"\u003eFROM\u003c/span\u003e movie_reviews \u003cspan class=\"hljs-keyword\"\u003eWHERE\u003c/span\u003e scores @\u003cspan class=\"hljs-operator\"\u003e\u0026gt;\u003c/span\u003e \u003cspan class=\"hljs-string\"\u003e\u0026#x27;{\u0026quot;nytimes\u0026quot;: 98}\u0026#x27;\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe above queries on a large table would be a great fit for a GIN index.\u003c/p\u003e\n\u003ch2 id=\"gin-and-full-text-search\"\u003eGIN and Full Text Search\u003c/h2\u003e\n\u003cp\u003eGIN, like we said before, is good for things where you can have one column that have multiple values that can return true. So what if we took our search term (in this case let\u0026#39;s search for \u003ccode\u003estar wars\u003c/code\u003e) and broke it down in smaller, searchable pieces? Like, three letter pieces, or as they\u0026#39;re called, \u003cem\u003etrigrams\u003c/em\u003e. This is one way PostgreSQL can handle full text search.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-sql\"\u003e\u003cspan class=\"hljs-keyword\"\u003eSELECT\u003c/span\u003e SHOW_TRGM(\u003cspan class=\"hljs-string\"\u003e\u0026#x27;star wars\u0026#x27;\u003c/span\u003e);\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThis shows you how PostgreSQL will break down star wars into multiple trigrams. It\u0026#39;ll then search based on these and will use GIN to index these in the same fashioned it can index JSONB. Wild one technology works so well in two different ways.\u003c/p\u003e\n\u003cpre\u003e\u003ccode class=\"hljs language-sql\"\u003eEXPLAIN ANALYZE \u003cspan class=\"hljs-keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e*\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFROM\u003c/span\u003e movies \u003cspan class=\"hljs-keyword\"\u003eWHERE\u003c/span\u003e name ILIKE \u003cspan class=\"hljs-string\"\u003e\u0026#x27;%star wars%\u0026#x27;\u003c/span\u003e;\n\n\u003cspan class=\"hljs-keyword\"\u003eCREATE\u003c/span\u003e INDEX \u003cspan class=\"hljs-keyword\"\u003eON\u003c/span\u003e movies \u003cspan class=\"hljs-keyword\"\u003eUSING\u003c/span\u003e gin(name gin_trgm_ops);\n\nEXPLAIN ANALYZE \u003cspan class=\"hljs-keyword\"\u003eSELECT\u003c/span\u003e \u003cspan class=\"hljs-operator\"\u003e*\u003c/span\u003e \u003cspan class=\"hljs-keyword\"\u003eFROM\u003c/span\u003e movies \u003cspan class=\"hljs-keyword\"\u003eWHERE\u003c/span\u003e name ILIKE \u003cspan class=\"hljs-string\"\u003e\u0026#x27;%star wars%\u0026#x27;\u003c/span\u003e;\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe \u003ccode\u003egin_trgm_ops\u003c/code\u003e specifies the kind of indexing we want to do here and we\u0026#39;re saying we want \u003ccode\u003etrgm\u003c/code\u003e or trigram operations. This is what you do for full text search.\u003c/p\u003e\n\u003cp\u003eYou should see a large difference between the two queries. My machine got \u003ccode\u003ecost=0.00..4929.51\u003c/code\u003e for the first query and \u003ccode\u003ecost=28.13..88.65\u003c/code\u003e for the second query.\u003c/p\u003e\n\u003cblockquote\u003e\n\u003cp\u003eAs you can see, using the index is nearly half the cost of the second query and which is why we\u0026#39;d need a pretty big data set for the JSONB query to use the index.\u003c/p\u003e\n\u003c/blockquote\u003e\n","slug":"gin","title":"GIN","section":"Query Performance","icon":"fire","filePath":"/home/runner/work/complete-intro-to-sql/complete-intro-to-sql/lessons/09-query-performance/D-gin.md","nextSlug":"/lessons/query-performance/partial-indexes","prevSlug":"/lessons/query-performance/create-an-index"}},"__N_SSG":true},"page":"/lessons/[section]/[slug]","query":{"section":"query-performance","slug":"gin"},"buildId":"L1nvFuMYgj19ON5bFBK-W","isFallback":false,"gsp":true,"scriptLoader":[]}</script></body></html>